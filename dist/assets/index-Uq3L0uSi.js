(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const _ of a.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&n(_)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();const q="4.3.0",b="pkce-code-verifier";var I;(function(e){e.s="string",e.i="integer",e.b="boolean"})(I||(I={}));var l;(function(e){e.token_bundle="kinde_token",e.access_token="kinde_access_token",e.id_token="kinde_id_token",e.user="user",e.refresh_token="kinde_refresh_token"})(l||(l={}));class E extends Error{}E.prototype.name="InvalidTokenError";function fe(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,o)=>{let n=o.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function me(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return fe(t)}catch{return atob(t)}}function C(e,t){if(typeof e!="string")throw new E("Invalid token specified: must be a string");t||(t={});const o=t.header===!0?0:1,n=e.split(".")[o];if(typeof n!="string")throw new E(`Invalid token specified: missing part #${o+1}`);let s;try{s=me(n)}catch(a){throw new E(`Invalid token specified: invalid base64 for part #${o+1} (${a.message})`)}try{return JSON.parse(s)}catch(a){throw new E(`Invalid token specified: invalid json for part #${o+1} (${a.message})`)}}const pe=e=>document.cookie.split("; ").find(t=>t.split("=")[0]===e)?.split("=")[1];function he(e){const t=Array.from(new Uint8Array(e));return btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function _e(e){const o=new TextEncoder().encode(e);return window.crypto.subtle.digest("SHA-256",o)}async function we(e){const t=await _e(e);return he(t)}function H(){const e=new Uint32Array(28);return window.crypto.getRandomValues(e),Array.from(e,t=>("0"+t.toString(16)).substr(-2)).join("")}const ye=30,O=e=>{const t=Math.floor(Date.now()/1e3);return e.exp-ye>t},ke=async(e,t)=>{const o=H(),n=H(),s=await we(n);sessionStorage.setItem(`${b}-${o}`,JSON.stringify({codeVerifier:n,appState:t}));const a=new URL(e);return{state:o,code_challenge:s,url:a}},ve=()=>{let e={};return{reset:()=>{e={}},getItem:a=>e[a],removeItem:a=>{delete e[a]},setItem:(a,_)=>{e[a]=_}}},g=ve(),X=(e,t="access_token")=>{const o=g.getItem(`kinde_${t}`);return o?{name:e,value:o[e]}:null},y=(e,t="access_token")=>{const o=X(e,t);return o&&o.value},P=(e,t,o)=>{const n=y("feature_flags"),s=n&&n[e]?n[e]:{};if(s.v==null&&t==null)throw Error(`Flag ${e} was not found, and no default value has been provided`);if(o&&s.t&&o!==s.t)throw Error(`Flag ${e} is of type ${I[s.t]} - requested type ${I[o]}`);return{code:e,type:I[s.t||o],value:s.v==null?t:s.v,is_default:s.v==null}},Se=(e,t)=>{try{return P(e,t,"b").value}catch(o){return console.error(o),o}},be=(e,t)=>{try{return P(e,t,"i").value}catch(o){return console.error(o),o}},Ee=(e,t)=>{try{return P(e,t,"s").value}catch(o){return console.error(o),o}},Ie=()=>({orgCodes:y("org_codes","id_token")??[]}),$e=["iss","azp"],W=(e,t)=>{if(!e)throw new Error("ID token is required");if($e.forEach(n=>{if(!e.payload[n])throw new Error(`(${n}) claim is required.`);if(e.payload[n]!==t[n])throw new Error(`${n} claim mismatch. Expected: "${t[n]}", Received: "${e.payload[n]}"`)}),e.header.alg!=="RS256")throw new Error(`Unsupported signature alg. Expected: "RS256", Received: "${e.header.alg}"`);if(t.aud){if(!Array.isArray(e.payload.aud))throw new Error("(aud) claim must be an array");if(!t.aud.split(" ").every(a=>e.payload.aud.includes(a)))throw new Error(`(aud) claim mismatch. Expected: "${t.aud}", Received: "${e.payload.aud.join(", ")}"`)}if(!O(e.payload))throw new Error("Token expired");return!0},Ae=e=>new URL(e).hostname.split(".").slice(-2).join(".")!=="kinde.com",Ce=async e=>{if(!e)throw Error("Please provide your Kinde credentials");if(e!==Object(e))throw Error("The Kinde SDK must be initiated with an object");const{audience:t,client_id:o,domain:n,is_dangerously_use_local_storage:s=!1,redirect_uri:a,logout_uri:_=a,on_redirect_callback:j,on_error_callback:L,scope:T="openid profile email offline",proxy_redirect_uri:Q,_framework:Z,_frameworkVersion:M}=e;if(t&&typeof t!="string")throw Error("Please supply a valid audience for your api");if(T&&typeof T!="string")throw Error("Please supply a valid scope");if(!a||typeof e.redirect_uri!="string")throw Error("Please supply a valid redirect_uri for your users to be redirected after successful authentication");if(!n||typeof n!="string")throw Error("Please supply a valid Kinde domain so we can connect to your account");if(typeof s!="boolean")throw TypeError("Please supply a boolean value for is_dangerously_use_local_storage");const x=o||"spa@live",V=location.hostname==="localhost"||location.hostname==="127.0.0.1",k=!V&&!s&&Ae(n),$=V||s,f={audience:t,client_id:x,redirect_uri:a,authorization_endpoint:`${n}/oauth2/auth`,token_endpoint:`${n}/oauth2/token`,requested_scopes:T,domain:n,_framework:Z,_frameworkVersion:M},N=r=>{if(!r||r.error)return;const i=C(r.id_token),d=C(r.id_token,{header:!0}),c=C(r.access_token),u=C(r.access_token,{header:!0}),m={iss:n,azp:o,aud:t};W({payload:i,header:d},{...m,aud:o}),W({payload:c,header:u},m),g.setItem(l.token_bundle,r),g.setItem(l.access_token,c),g.setItem(l.id_token,i),i.sub&&g.setItem(l.user,{id:i.sub,given_name:i.given_name,family_name:i.family_name,email:i.email,picture:i.picture}),$?localStorage.setItem(l.refresh_token,r.refresh_token):g.setItem(l.refresh_token,r.refresh_token)},A=async({tokenType:r}={tokenType:l.access_token})=>{const i=$?localStorage.getItem(l.refresh_token):g.getItem(l.refresh_token);if(i||k&&pe("_kbrte"))try{const u=await(await fetch(f.token_endpoint,{method:"POST",...k&&{credentials:"include"},headers:new Headers({"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","Kinde-SDK":`
            ${f._framework||"JavaScript"}/${f._frameworkVersion||q}`}),body:new URLSearchParams({client_id:f.client_id,grant_type:"refresh_token",...!k&&i&&{refresh_token:i}})})).json();return N(u),r===l.id_token?u.id_token:u.access_token}catch(c){console.error(c)}},D=async(r,i)=>{const d=g.getItem(l.token_bundle);if(!d||i.isForceRefresh)return await A({tokenType:r});const c=g.getItem(r);return O(c)?r===l.access_token?d.access_token:d.id_token:await A({tokenType:r})},K=async(r={})=>await D(l.access_token,r),ee=async(r={})=>await D(l.id_token,r),te=async()=>{const r=g.getItem(l.access_token);return r?(O(r)||await A(),!0):!1},re=()=>{const r=y("org_code");return{permissions:y("permissions")??[],orgCode:r}},oe=r=>{const i=y("org_code");return{isGranted:(y("permissions")??[]).some(c=>c===r),orgCode:i}},ne=()=>({orgCode:y("org_code")}),F=()=>{const r=new URL(window.location.toString());r.search="",window.history.pushState({},"",r)},se=async r=>{const i=r.get("code"),d=r.get("state"),c=r.get("error");if(c?.toLowerCase()==="login_link_expired"){const m=r.get("reauth_state");if(m){const h=atob(m);try{const p=JSON.parse(h);p&&J(p)}catch(p){throw new Error(p instanceof Error?p.message:"Unknown Error parsing reauth state")}}return}const u=sessionStorage.getItem(`${b}-${d}`);if(!u)console.error("Invalid state");else{if(c){const p=r.get("error"),v=r.get("error_description");F(),sessionStorage.removeItem(`${b}-${d}`);const{appState:w}=JSON.parse(u);return L?L({error:p,errorDescription:v,state:d,appState:w}):window.location.href=w.kindeOriginUrl,!1}const{appState:m,codeVerifier:h}=JSON.parse(u);try{const v=await(await fetch(f.token_endpoint,{method:"POST",...k&&{credentials:"include"},headers:new Headers({"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","Kinde-SDK":`${f._framework||"JavaScript"}/${f._frameworkVersion||q}`}),body:new URLSearchParams({client_id:f.client_id,code:i,code_verifier:h,grant_type:"authorization_code",redirect_uri:f.redirect_uri})})).json();N(v),F(),sessionStorage.removeItem(`${b}-${d}`);const w=z();j&&j(w,m)}catch(p){console.error(p),sessionStorage.removeItem(`${b}-${d}`)}}},U=async r=>{const{app_state:i={},prompt:d,is_create_org:c,org_name:u="",org_code:m,authUrlParams:h={}}=r;i.kindeOriginUrl||(i.kindeOriginUrl=window.location.href);const{state:p,code_challenge:v,url:w}=await ke(f.authorization_endpoint,i),S={redirect_uri:a,client_id:x,response_type:"code",scope:f.requested_scopes,code_challenge:v,code_challenge_method:"S256",state:p,supports_reauth:"true"};d&&(S.prompt=d),m&&(S.org_code=m),c&&(S.is_create_org=String(c),S.org_name=u);const B=new URLSearchParams(Object.assign(h,S));t&&t.trim().split(/\s+/).forEach(ge=>{B.append("audience",ge)}),w.search=String(B),window.location.href=w.toString()},ae=async r=>{await U({...r,prompt:"create"})},J=async r=>{await U({...r})},ie=async r=>{await U({...r,prompt:"create",is_create_org:!0})},z=()=>g.getItem(l.user),ce=async()=>{const i={Accept:"application/json",Authorization:`Bearer ${await K()}`};try{const c=await(await fetch(`${f.domain}/oauth2/v2/user_profile`,{method:"GET",headers:i})).json();return g.setItem(l.user,{id:c.sub,given_name:c.given_name,family_name:c.family_name,email:c.email,picture:c.picture}),g.getItem(l.user)}catch(d){console.error(d)}},de=async()=>{const r=new URL(`${f.domain}/logout`);try{g.reset(),$&&localStorage.removeItem(l.refresh_token);const i=new URLSearchParams({redirect:_});r.search=String(i),window.location.href=r.toString()}catch(i){console.error(i)}},le=async()=>{const r=new URLSearchParams(window.location.search);ue(r)?await se(r):(k||$)&&await A()},ue=r=>{const i=r.has("code"),d=r.has("error");if(!i&&!d)return!1;const{protocol:c,host:u,pathname:m}=window.location,h=Q||`${c}//${u}${m}`;return h===a||h===`${a}/`};return await le(),{getToken:K,getIdToken:ee,getUser:z,getUserProfile:ce,login:J,logout:de,register:ae,isAuthenticated:te,createOrg:ie,getClaim:X,getFlag:P,getBooleanFlag:Se,getStringFlag:Ee,getIntegerFlag:be,getPermissions:re,getPermission:oe,getOrganization:ne,getUserOrganizations:Ie}},Pe=document.getElementsByClassName("js-logged-in-view"),Te=document.getElementsByClassName("js-logged-out-view"),Y=(e,t)=>{[...e].forEach(o=>o.removeAttribute("hidden")),[...t].forEach(o=>o.setAttribute("hidden",!0))},Ue=e=>{const t=document.querySelector(".js-user-name"),o=document.querySelector(".js-user-avatar"),n=document.querySelector(".js-user-avatar-picture");t.textContent=`${e.given_name} ${e?.family_name||""}`,`${e.picture}`!=""?(n.src=`${e.picture}`,n.removeAttribute("hidden")):(o.textContent=`${e.given_name[0]}${e?.family_name?.[0]||e.given_name[1]}`,o.removeAttribute("hidden")),Y(Pe,Te)},Oe=()=>{const e=document.getElementsByClassName("js-logged-in-view"),t=document.getElementsByClassName("js-logged-out-view");Y(t,e)},Re=async e=>{e?Ue(e):Oe()},R=await Ce({client_id:"6816c0b48dc84cd9b26ae44b18bc18ad",domain:"https://auth.jamstack-auth.publicntp.net",redirect_uri:"https://jamstack-auth.publicntp.net"}),je=e=>{document.getElementById(e).addEventListener("click",async()=>{await R[e]()})};["login","register","logout"].forEach(je);const Le=await R.getUser();await Re(Le);const G=await R.getToken();G!==void 0&&console.log(`Using header:
    Authorization: Bearer `+G);
